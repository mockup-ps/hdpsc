(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[46],{638:function(e,t,n){"use strict";var c=n(672),s=Object(c.a)("https://ctvjpxocqeajngziaxji.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyMzE4Mjc3OSwiZXhwIjoxOTM4NzU4Nzc5fQ.pCQD8_U0cgWJtgLbOh90kUGpxpOmpwzDmsfwKzj7PwE");t.a=s},784:function(e,t,n){"use strict";n.r(t);var c=n(660),s=n(634),a=n.n(s),i=n(639),r=n(164),l=n(43),d=n(630),o=n(628),j=n(1),b=n(162),u=n(638),f=n(19),O=n(645),x=n.n(O),h=n(20),k=function(){return Object(h.jsx)("div",{className:"d-flex flex-row justify-content-center",children:Object(h.jsx)("div",{children:Object(h.jsx)(o.f,{className:"btn btn-sm btn-success",children:Object(h.jsx)("i",{class:"fas fa-eye"})})})})},m=function(e){var t=Object(j.useState)(!1),n=Object(d.a)(t,2),c=n[0],s=n[1],f=Object(j.useState)([]),O=Object(d.a)(f,2),x=O[0],k=O[1],m=(Object(b.c)((function(e){return e.simView})),["Dit. KPLP","Dit. KAPEL","BKI","Kemenlu"]),p=Object(j.useState)(),y=Object(d.a)(p,2);y[0],y[1];return Object(j.useEffect)(Object(i.a)(a.a.mark((function t(){var n,c,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.from("td_deficiency").select("\n        data, \n        id_deficiency\n        ").eq("id_detensi",e.datadetensi.id_detensi);case 2:n=t.sent,c=n.data,n.error,s=c.map((function(e){var t;return Object(l.a)(Object(l.a)({},e.data),{},(t={},Object(r.a)(t,"id_deficiency",e.id_deficiency),Object(r.a)(t,"responsiblero",m[e.data.responsiblero-1]),t))})),k(s),console.log(s);case 8:case"end":return t.stop()}}),t)}))),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(o.db,{size:"xl",show:c,onClose:function(){return s(!1)},children:[Object(h.jsx)(o.gb,{children:Object(h.jsx)("h5",{children:Object(h.jsx)("i",{children:"Correction Action Plan"})})}),Object(h.jsx)(o.eb,{children:Object(h.jsx)("div",{className:"mt-3",children:Object(h.jsx)(o.y,{addTableClasses:"josss",items:x,fields:[{key:"no",label:"No"},{key:"natureofdeficiency",label:"Nature of Deficiency"},{key:"actiontaken",label:"Code"},{key:"issuingauthority",label:"Issuing Authority"},{key:"actionplan",label:"Action Plan"},{key:"result",label:"Result"},{key:"remark",label:"Remarks"},{key:"doc",label:"Documentation"}],scopedSlots:{doc:function(e,t){return Object(h.jsx)("td",{children:Object(h.jsx)("div",{className:"d-flex justify-content-center",children:Object(h.jsx)(o.f,{className:"btn btn-success btn-sm",children:Object(h.jsx)("i",{class:"far fa-file"})})})})},result:function(e,t){return Object(h.jsx)("td",{children:Object(h.jsx)(o.Ib,{})})},remark:function(e,t){return Object(h.jsx)("td",{children:Object(h.jsxs)(o.ub,{children:[Object(h.jsx)("option",{value:"0",children:"NOT CLOSED"}),Object(h.jsx)("option",{value:"1",children:"CLOSED"})]})})},actiontaken:function(e,t){return Object(h.jsx)("td",{children:e.actiontaken.value})},responsiblero:function(e,t){return console.log(e),Object(h.jsx)("td",{children:e.responsiblero?"Yes":"No"})},no:function(e,t){return Object(h.jsx)("td",{children:t+1})},actionplan:function(e,t){return Object(h.jsx)("td",{children:Object(h.jsx)(o.Ib,{})})}}})})}),Object(h.jsx)(o.fb,{children:Object(h.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(h.jsx)("div",{className:"mr-2",children:Object(h.jsx)(o.f,{onClick:function(){return s(!1)},color:"success",children:"Simpan"})}),Object(h.jsx)("div",{className:"mr-2",children:Object(h.jsx)(o.f,{onClick:function(){return s(!1)},color:"danger",children:"Batal"})})]})})]}),Object(h.jsx)("div",{className:"d-flex flex-row justify-content-center",children:Object(h.jsx)("div",{children:Object(h.jsx)(o.f,{onClick:function(){return s(!0)},className:"btn btn-sm btn-info",children:Object(h.jsx)("i",{class:"fas fa-wrench"})})})})]})},p=function(e){var t=Object(f.g)(),n=Object(b.b)(),c=Object(b.c)((function(e){return e.simView}));return Object(h.jsxs)("div",{className:"d-flex flex-row justify-content-center",children:[e.disabled,Object(h.jsx)("div",{children:Object(h.jsx)("div",{children:Object(h.jsx)(o.f,{disabled:e.disabled,onClick:function(){e.datadetensi.fl_lock?(t.push("/hdpsc/edit"),n({type:"set",datadetensi:e.datadetensi})):x.a.fire({icon:"question",text:"Apakah Anda Yakin ingin Men-Check Out informasi ini ?",showConfirmButton:!0,showDenyButton:!0,denyButtonText:"Tidak",confirmButtonText:"Ya"}).then((function(s){s.isConfirmed&&function(){var s=Object(i.a)(a.a.mark((function s(i){var r,l;return a.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u.a.from("td_detensi").update({fl_lock:1,locked_by:c}).eq("id_detensi",i);case 2:if((r=s.sent).data,!(l=r.error)){s.next=9;break}return s.abrupt("return",l);case 9:t.push("/hdpsc/edit"),n({type:"set",datadetensi:e.datadetensi});case 11:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()(e.datadetensi.id_detensi)}))},className:e.fl_lock&&e.disabled?"btn btn-sm btn-success":e.fl_lock?"btn btn-sm btn-warning":"btn btn-sm btn-success",children:e.fl_lock&&e.disabled?Object(h.jsx)("i",{class:"fas fa-check"}):e.fl_lock?Object(h.jsx)("i",{class:"fas fa-pencil-alt"}):Object(h.jsx)("i",{class:"fas fa-check"})})})})]})};t.default=function(){var e=Object(b.b)(),t=["Direktorat KPLP","Direktorat KAPEL","BKI","Kemenlu","Kemenkomarves"],n=Object(f.g)(),s=Object(j.useState)([]),O=Object(d.a)(s,2),y=O[0],_=O[1],g=Object(j.useState)([]),v=Object(d.a)(g,2),w=v[0],N=v[1],C=["success","primary","warning","info","danger","light"],D=Object(j.useState)(!1),I=Object(d.a)(D,2),S=I[0],A=I[1],K=Object(b.c)((function(e){return e.simView})),B=Object(j.useState)({}),P=Object(d.a)(B,2),M=P[0],T=P[1],E=function(e){T(Object(l.a)(Object(l.a)({},M),{},Object(r.a)({},e.target.name,e.target.value)))},J=function(){var t=Object(i.a)(a.a.mark((function t(){var c,s,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!M.imokapal||!M.tgldetensi){t.next=9;break}return t.next=3,u.a.from("td_detensi").select("*").eq("data->imokapal",JSON.stringify(M.imokapal)).eq("data->tgldetensi",JSON.stringify(M.tgldetensi));case 3:c=t.sent,s=c.data,c.error,s.length?x.a.fire({icon:"error",title:"Oops...",text:"Data Detensi tersebut Sudah Pernah Diajukan Sebelumnya"}):((i={}).imokapal=M.imokapal,i.tgldetensi=M.tgldetensi,e({type:"set",initial:i}),x.a.fire({icon:"success",title:"Validasi Sukses",html:"Anda Akan Diarahkan ke Halaman Selanjutnya",timer:1500,timerProgressBar:!0}).then((function(e){n.push("/hdpsc/new")}))),t.next=10;break;case 9:console.log(M.imokapal,M.tgldetensi);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(j.useEffect)(Object(i.a)(a.a.mark((function e(){var t,n,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.from("td_detensi").select("\n            id_detensi,\n            data,\n            fl_lock,\n            locked_by,\n            tr_status (\n                kd_status,\n                ur_status\n            ),\n            th_detensi (\n                kd_status,\n                created_at,\n                createdby,\n                locked_by\n            )\n        ");case 2:return t=e.sent,e.next=5,u.a.from("tr_status").select("\n            kd_status,\n            ur_status\n        ");case 5:n=e.sent,c=t.data.map((function(e){var t;return Object(l.a)(Object(l.a)(Object(l.a)(Object(r.a)({},"id_detensi",e.id_detensi),e.data),e.tr_status),{},(t={},Object(r.a)(t,"histori",e.th_detensi),Object(r.a)(t,"locked_by",e.locked_by),Object(r.a)(t,"fl_lock",e.fl_lock),t))})),_(c),console.log(n);case 9:case"end":return e.stop()}}),e)}))),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(o.db,{show:S,onClose:function(){return A(!1)},children:[Object(h.jsx)(o.gb,{children:Object(h.jsx)("h5",{children:"Masukkan Data Awal"})}),Object(h.jsxs)(o.eb,{children:[Object(h.jsx)(o.tb,{children:Object(h.jsx)(o.u,{md:"12",children:Object(h.jsxs)(o.K,{children:[Object(h.jsx)(o.Z,{children:"Nomor IMO Kapal"}),Object(h.jsx)(o.P,{value:M.imokapal,name:"imokapal",onChange:function(e){return E(e)},type:"text"})]})})}),Object(h.jsx)(o.tb,{children:Object(h.jsx)(o.u,{md:"12",children:Object(h.jsxs)(o.K,{children:[Object(h.jsx)(o.Z,{children:"Tanggal Detensi"}),Object(h.jsx)(o.P,{value:M.tgldetensi,name:"tgldetensi",onChange:function(e){return E(e)},type:"date"})]})})})]}),Object(h.jsx)(o.fb,{children:Object(h.jsxs)("div",{className:"d-flex justify-content-end",children:[Object(h.jsx)("div",{className:"mr-2",children:Object(h.jsx)(o.f,{onClick:function(){return J()},color:"success",children:"Lanjutkan"})}),Object(h.jsx)("div",{className:"mr-2",children:Object(h.jsx)(o.f,{onClick:function(){return A(!1)},color:"danger",children:"Batal"})})]})})]}),Object(h.jsxs)(o.j,{children:[Object(h.jsx)(o.n,{children:Object(h.jsx)("h5",{children:"Data Detensi Kapal"})}),Object(h.jsxs)(o.k,{children:[1==K||2==K||3==K?Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"d-flex justify-content-end mb-2",children:Object(h.jsxs)(o.f,{onClick:function(){return A(!0)},className:"btn btn-info",children:["Buat Baru ",Object(h.jsx)("i",{class:"fas fa-plus"})]})})}):Object(h.jsx)(h.Fragment,{}),Object(h.jsx)(o.y,{addTableClasses:"josss",items:y,fields:[{key:"no",label:"No",_style:{width:"5%"}},{key:"namakapal",label:"Nama Kapal"},{key:"imokapal",label:"Nomor IMO Kapal"},{key:"tgldetensi",label:"Tanggal Detensi"},{key:"status",label:"Status"},{key:"lock",label:"Available ?",_style:{width:"15%"}},{key:"action",label:"Action"}],scopedSlots:{lock:function(e,n){var c,s;return s=e.locked_by==K?"Me":t[e.locked_by-1],c=e.fl_lock?"Checked Out by "+s:"Available",Object(h.jsx)("td",{children:c})},no:function(e,t){return Object(h.jsx)("td",{children:t+1})},status:function(e,t){return Object(h.jsx)("td",{children:Object(h.jsx)(o.b,{onClick:function(){!function(e){var t=w.indexOf(e),n=w.slice();-1!==t?n.splice(t,1):n=[].concat(Object(c.a)(w),[e]),N(n)}(t)},role:"button",color:C[parseInt(e.kd_status)-1],children:e.ur_status})})},action:function(e,n){console.log(e),console.log();var c,s=t[e.locked_by-1];return c=!!e.fl_lock&&e.locked_by!=K,Object(h.jsx)("td",{children:1!=K&&2!=K&&3!=K||3!=e.kd_status?1==K||2==K||3==K?Object(h.jsx)(p,{fl_lock:e.fl_lock,locker:s,disabled:c,datadetensi:e}):Object(h.jsx)(k,{}):Object(h.jsx)(m,{datadetensi:e})})},details:function(e,n){return console.log(e),Object(h.jsx)(o.v,{show:w.includes(n),children:e.histori.map((function(e){var n=new Date(e.created_at),c=n.getDate(),s=n.getMonth()+1,a=n.getFullYear(),i=n.getHours(),r=n.getMinutes(),l=n.getSeconds();return Object(h.jsxs)("div",{className:"d-flex flex-row justify-content-end mx-3 my-3",children:[Object(h.jsx)("div",{className:"d-flex flex-column justify-content-center mr-2",children:Object(h.jsx)(o.b,{color:C[parseInt(e.kd_status)-1],children:1==e.kd_status?"Initial Info":2==e.kd_status?"Cetakan Form A & B":3==e.kd_status?"Data Elektronik Form A & B":4==e.kd_status?"Corrective Action Plan":5==e.kd_status?"Locked By "+t[e.locked_by-1]:6==e.kd_status?"Unlocked By "+t[e.locked_by-1]:""})}),Object(h.jsxs)("div",{style:{minWidth:"15vw"},className:"d-flex flex-column",children:[1==c.toString().length?"0"+c:c,"-",1==s.toString().length?"0"+s:s,"-",a," ",i,":",r,":",l]}),Object(h.jsx)("div",{style:{minWidth:"15vw"},className:"d-flex flex-column",children:t[parseInt(e.createdby)-1]})]})}))})}}})]})]})]})}}}]);
//# sourceMappingURL=46.f2183ae4.chunk.js.map